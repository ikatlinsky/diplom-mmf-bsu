% !TEX root = ../DiplomProject.tex

\section{Метод Полларда}

\paragraph{} Пусть $N$ – нечетное составное число, $S = {0, 1, \dots, N - 1}$ и $f:S \rightarrow S$ – случайное отображение, 
обладающее сжимающими свойствами, например $f(x)=x^{ 2} + 1(mod \: N)$. Основная идея метода состоит в следующем. Выбираем случайный 
элемент $x_{0}$ из $S$ и строим последовательность $ {x_{0}, x_{1}, \dots, } $
определяемую рекуррентным соотношением $x_{i+1}=f(x_{i})$, где $i \ge 0$, до тех пор, пока не 
найдем числа $i$, $j$, такие что $i < j$ и $x_{i} = x_{j}$. Поскольку множество $S$ 
конечно, такие индексы $i$, $j$ существуют.

  Если $p$ - простой делитель числа $N$ и $x_{i} \equiv x_{j}(mod \: p)$, то разность
$x_{i} - x_{j}$ делится на $p$ и $GCD(x_{i} - x_{j}, N) > 1$. Нетривиальный 
наибольший делитель $1 < d < N$ и будет искомым делителем $p$ числа $N$. Вероятность случая $d = N$ крайне мала.

  Если последовательно вычислять значения $x_{i+1}=f(x_{i})$, запоминать их и искать равные, то в среднем число шагов 
алгоритма будет равно $( \pi (\frac{N}{2}))^{ \frac{1}{2}}$, где $\pi(C)$ - число простых чисел, ограниченных сверху константой $C$ (смотри таблицу \ref{pi-c-label}). 
Кроме того, временная сложность алгоритма равна $O(N^{ \frac{1}{2}})$ - \cite[Глава 2.2, страницы 54-60]{ish11}, \cite[Глава 2.4, страницы 61-65]{ish11}.

  \begin{table}[h]
    \centering
    \begin{tabular}{|l|l|}
    \hline
      Граница C & Число простых $\pi(C)$ \\ \hline
      256       & 54                     \\ \hline
      1000      & 168                    \\ \hline
      10000     & 1229                   \\ \hline
      100000    & 9592                   \\ \hline
      1000000   & 78498                  \\ \hline
    \end{tabular}
    \caption{$\pi(C)$}
    \label{pi-c-label}
  \end{table}

  \subsection{Алгоритм ($\rho-$метод Полларада)}
  
  Вход: Число $N$, начальное значение $c$, функция $f$  \\
  Выход: нетривиальный делитель $p$ числа $N$
  
    \begin{enumerate}
     \item Необходимо выбрать некоторый элемент $x_0 \in Z_n$, положить, что $k = 1$, $h = 0$, $j=2^h-1$.
     \item Вычисляем $x_k = f(x_{k-1})(mod \: N)$.
     \item Если $k \ge 2^{h+1}$ , то $h = h + 1$, $j := 2^h - 1$.
     \item Найти $d = GCD(x_k - x_j, N)$
     \item Если $1 < d < N$, то $d$ - делитель, конец алгоритма, при $d = N$ результат не найден, неудачно выбрана начальная точка $x_0$ - переходим на шаг 1
     \item Увеличиваем $k$ на единицу $k = k + 1$ и переходим к шагу 2.
    \end{enumerate}
  
  \begin{example}
    Необходимо найти нетривиальный делитель числа $n = 1373503$. На первом шаге положим $c = 2$, $f(x) = (x^{2} - 2)(mod \: n)$, 
    получаем, что $a = b = 2$ и $d = 1373503 = n$, значит надо поменять отображение $f(x)$, пусть оно будет в виде 
    $f(x) = (x^{2} - 22)(mod \: n)$, за 5 итераций в итоге получим, что $a = 777096$, $b = 742847$ и $d = 1181$. 
    Действительно $n = 1181 \times 1163$.
  \end{example}  

\section{Метод квадратов}

\paragraph{} Рассмотрим теорему Ферма о разложении

  \begin{theorem}
    Для любого положительного нечетного числа $N$ существует взаимно однозначное соответствие между множеством делителей числа $N$, 
    не меньших, чем $N^{ \frac{1}{2}}$, и множеством пар ${s, t}$ таких неотрицательных целых чисел, что 
    $N = s^{ 2} - t^{ 2}$
  \end{theorem}

  Если $N = p \times q$, где числа $p$ и $q$ близки друг к другу, то число $t$ мало, а значит, $s$ немного больше,
  чем $N^{\frac{1}{2}}$. В этом случае можно найти $p$ и $q$, последовательно перебирая числа
  $s=[N^{ \frac{1}{2}}]+1, [N^{ \frac{1}{2}}]+2, \dots$ до тех пор, пока не найдется 
  такое $s$, что разность $s^{ 2} - N$ является полным квадратом, то есть равна $t^{ 2}$ - 
  \cite[Глава 6.4, страницы 216-225]{mah06}.
  
  \begin{example}
    Нужно разложить на множители число n = 1406303 методом Ферма. Вычисляем по шагам:
	\begin{enumerate}
	\item $s = [N^{ \frac{1}{2}}] + 1 = 1185 + 1 = 1186, s^{2} - n = 1186^{2} - 1406303 = 293$
	\item $s = [N^{ \frac{1}{2}}] + 2 = 1185 + 2 = 1187, s^{2} - n = 1187^{2} - 1406303 = 2666$
	\item $s = [N^{ \frac{1}{2}}] + 3 = 1185 + 3 = 1188, s^{2} - n = 1188^{2} - 1406303 = 71^{2}$
	\end{enumerate}

    Таким образом получили, что $s = 1188$, $t = 71$, $p = s - t = 1117$, $q = s + t = 1259$, как результат 
    $N = 1117 \times 1259$
  \end{example}


\section{Обобщенный метод Ферма}

  \paragraph{} Понятно, что чем больше разность между числами $p$ и $q$, тем более трудоемким становится метод Ферма, в этом случае 
  можно воспользоваться обобщенным методом Ферма: для небольшого целого числа $k$ последовательно вычислять 
  $s = [(kN)^{ \frac{1}{2}}] + 1, [(kN)^{ \frac{1}{2}}] + 2, \dots$ пока не получится такое число $s$, 
  что разность $s^{2} - kn$ является полным квадратом, то есть равна $t^{2}$. Отсюда
  $(s + t)\times(s - t) = kN$, и значит, числа $s - t$ и $N$ имеют нетривиальный общий делитель - 
  \cite[Глава 2.1, страницы 51-53]{ish11}.
  
  \begin{example}
    Нужно разложить на множители число $N = 5338771$. Если будем использовать стандартный метод Ферма, то разложение получим лишь на 160 шаге
    
      \begin{subequations}
	\begin{align}
	  s = [N\textsuperscript{ {$\frac{1}{2}$}}] + 160 = 2310 + 160 = 2470, \\
	  t\textsuperscript{2} = 2470\textsuperscript{2} - 5338771 = 762129, \\
	  t = 873, s + t = 3343, s - t = 1597, 
       \end{align}
      \end{subequations}	
    
    однако выбрав $k = 8$ решим задачу на 2ом шаге: 
      \begin{equation}
       ([(kN)^{ \frac{1}{2}}] + 2)^{2} - k n = 6537^{2} - 8 5338771 = 149^{2}
      \end{equation}	
	
    А значит мы получили, что $s = 6537$, $t = 149$ , $s - t = 6537 - 148 = 6388$, $GCD(s - t, N) = 1597$ и $N = 1597 \times 3343$
  \end{example}


\section{Метод Диксона}

\paragraph{} Поскольку подобрать такое число $k$ нелегко, на практике часто для разложения числа $N$ достаточно найти такие целые числа $s$,
$t$, что $s^{2} \equiv t^{2}(mod \: N)$, то есть такие, что $(s + t)(s - t) \equiv 0 (mod \: N)$. 
Если $s \equiv \pm t(mod \: N)$, то число $N$ делит произведение двух чисел $s + t$ и $s - t$, но не делит ни один 
из сомножителей, значит, один делитель числа $N$ делит разность $s - t$, а другой делитель $q = \frac{N}{p}$ делит сумму $s + t$.
Описанный выше метод называется методом Диксона - \cite[Глава 4.1, страницы 115-117]{ish11}, \cite[Глава 6.4, страницы 218-219]{mah06}.

  \subsection{Алгоритм Диксона}
  Вход: составное число $N$
  Выход: нетривиальный делитель $p$ числа $N$
  
    \begin{enumerate}
     \item Построить базу разложения $B = {p_{0}, p_{1}, \dots, p_{h}}$, 
     где $p_{0} = -1$ и $p_{1}, \dots, p_{h}$ - попарно различные простые числа.

     \item Найти $h + 2$ целых числа $s_{i}$, для каждого из которых абсолютно наименьший вычет
     $s_{i}^{2}(mod \: N)$ является \textit{B-гладким}:     
      	\begin{equation} \label{eq:prime-fact-si}
      	  s_{i}^{2}(mod \: N) = \prod_{j=0}^{h}{p_j^{\alpha_{j} (s_i)}},
      	\end{equation}
      где $\alpha_{j} (s_i) \ge 0$, и каждому числу $s_i$ сопоставить вектор показателей \\
      $(\alpha_0(s_i), \alpha_1(s_i), \dots, \alpha_h(s_i))$.
     
     \item Найти непустое множество $K \subseteq (1, 2, \dots, h+2)$ такое, что $\oplus e_{k} = 0$, $\oplus e_{k} = \sum_{k \in K}{e_k} \equiv \: 0 (mod \: 2)$, 
     то есть такие $e_k$, которые являются линейно-независимыми компонентами, $k \in K$, где      
    	\begin{equation} \label{eq:prime-fact-ek}
    	  e_k = (e_1^k, e_2^k, \dots, e_h^k), e_j^k \equiv \alpha_j(s_k)(mod \: 2), 0 \le j \le h
    	\end{equation}     
     \item Положить      
    	\begin{equation} \label{eq:prime-fact-sprod}
    	  s = \prod_{k \in K}{s_k(mod \: N)}, t = \prod_{i=1}^{h}{p_{i}^{\frac{1}{2} \sum_{k \in K}{\alpha_i (s_k)}}(mod \: N)},
    	\end{equation}     
     тогда $s^{2} \equiv t^{2}(mod \: N)$.
     \item Если $s \not\equiv \pm t(mod \: N)$, то $p = GCD(s - t, N)$ и возвращаем $p$, иначе возвращаемся на шаг 3 и меняем множество $K$
    \end{enumerate}
  

\section{Метод квадратичного решета}

\paragraph{} Модификация выбора чисел $s_{i}$ в алгоритме Диксона была разработана К. Померанцем в 1981 году. Долгое время метод квадратичного решета 
превосходил другие методы факторизации целых чисел общего вида, не имеющих простых делителей, порядок которых значительно меньше $\sqrt{N}$ 
(для чисел $N$, имеющих простые делители, много меньшие более быстрым является метод факторизации на эллиптических кривых). 
Метод квадратичного решета представляет собой разновидность метода факторных баз (обобщение метода факторизации Ферма). 
Этот метод считается вторым по быстроте (после общего метода решета числового поля). И до сих пор является самым быстрым для 
целых чисел до 100 десятичных цифр и устроен значительно проще чем общий метод решета числового поля. Это универсальный алгоритм факторизации, 
так как время его выполнения исключительно зависит от размера факторизуемого числа, а не от его особой структуры и свойств.

  В качестве модификации мы рассматриваем функцию    
    \begin{equation} \label{eq:prime-fact-fx1}
      f(x) = (x + [\sqrt{N}])^{2} - N = x^{2} + 2[\sqrt{N}]x + [\sqrt{N}]^{2} - N
    \end{equation}    

  Так как $f(x) \approx x^{2} + 2[\sqrt{N}]x$, при малых значениях $x$, $-c \le x \le c$, $c$ - константа, значение $f(x)$ тоже мало, и с большой вероятностью легко раскладывается на множители, таким образом в качестве $s_{i}$ можно брать значения $f(x)$, где $-c \le x \le c$ -
  \cite[Глава 6.4, страница 222]{mah06}.
  
  Если $f(x)$ делится на простое число $p_{i} \ne 2$ для некоторого целого \textit{x}, то сравнение  
    \begin{equation} \label{eq:prime-fact-fx2}
      f(x) = (x + [\sqrt{N}])^{2} \equiv N(mod \: p_{i})
    \end{equation}    
  выполняется только в том случае если $N$ – квадратичный вычет по модулю $p_{i}$, то есть в базу разложения следует включать 
  только те нечетные простые числа $p_{i}$, для которых $\binom{N}{p_{i}} = 1$ \cite[Глава 6.4, страница 223]{mah06}.
  
  % Чтобы числа $f(x)$ были с большей вероятностью \textit{B-гладкими}, осуществляется просеивание: решая сравнение (\ref{eq:prime-fact-fx2}) относительно $x_{2}$
  % каждого простого числа $p_{i} \ne 2$ из базы разложения, в результате получим 2 решения $x_{1}$ и $x_{2}$. 
  % Тогда все целые числа вида $x_{j}(p_{i}) + k p_{i}$ будут удовлетворять сравнению. Таким образом, в 
  % интервале $[-c, c]$ можно оставить только те числа $x$, которые удовлетворяют сравнению $x \equiv x_{1}(p_{i})(mod \: p_{i})$ 
  % или $x \equiv x_{2}(p_{i})(mod \: p_{i})$ для достаточно большого числа элементов 
  % $p_{i}$ из $B$.
  
  Оптимальное значение $h$ в этом алгоритме $O(exp(\frac{1}{2}\sqrt{\ln{n}\ln{\ln{n}}}))$. Временная сложность 
  алгоритма равна $O(exp(\sqrt{\ln{n}\ln{\ln{n}}}))$ - \cite[Глава 4, страницы 115-142]{ish11}.

  \subsection{Алгоритм квадратичного решета}
  Пусть {$n$} - нечетное составное число, которое требуется факторизовать - \cite[Глава 4, страница 115-145-225]{ish11}.

  % \begin{comment}
  %   \begin{enumerate}
  %     \item Выбираются границы $P$ и $A$ порядка величины 
  %       \begin{equation}
  %         e^{\sqrt{\log{n}\log{\log{n}}}}
  %       \end{equation}
  %       (далее обозначается как $L(n)$), такие что $P < A < P^2$.
  %     \item Для 
  %       \begin{equation}
  %         t = [\sqrt{n}] + 1, \left[\sqrt{n}\right] + 2, \dots, \left[\sqrt{n}\right] + A
  %       \end{equation}
  %       по порядку в столбец выписываются целые числа $t^2 - n$.
  %     \item Для каждого нечетного простого числа $p \le P$ проверяется условие $\left( \frac{n}{p}\right) = 1$. Если оно не выполняется, $p$ удаляется из факторной базы.
  %     \item Предполагая, что $p$ - такое нечетное простое число, что $n$ - квадратичный вычет по модулю $p$, решается уравнение 
  %       \begin{equation}
  %         t^{2} \equiv n \pmod{p^{\beta}}
  %       \end{equation}
  %      для $\beta = 1,2, \dots$. Значения $\beta$ берутся в порядке возрастания пока не окажется, что уравнение не имеет решений $t$, сравнимых по модулю $p^{\beta}$ с каким-либо из чисел в области
  %       \begin{equation}
  %         \left[\sqrt{n}\right]+1 \le t \le \left[\sqrt{n} \right] + A.
  %       \end{equation}
  %      Пусть $\beta$ - наибольшее из таких чисел, для которых в указанной области найдется число $t$ со свойством $t^2 \equiv n \pmod{p^{\beta}}$. \\
  %      Пусть $t_1$ и $t_2$ решения $t^2 \equiv n\pmod{p^{\beta}}$ и $t_2 \equiv -t_1\pmod{p^{\beta}}$.
  %     \item При том же значении $p$ просматривается список значений $t^2 - n$, полученный в п.2. В столбце, соответствующем $p$, ставится 1 против всех значений $t^2 - n$, для 
  %       которых $t$ отличается от $t_1$ на некоторое кратное $p$. После этого 1 заменяется на 2 для всех таких значений $t^2 - n$, что $t$ отличается от $t_1$ на кратное $p^2$ и так
  %       далее до $\beta$. Затем то же самое проделывается с $t_2$ вместо $t_1$. Наибольшее возможное число в столбце - $\beta$.
  %     \item При добавлении очередной единицы к числу в столбце в п.5, соответствующее число $t^2 - n$ делится на $p$ и полученный результат сохраняется.
  %     \item В столбце под $p=2$ при $n \not\equiv 1 \pmod{2}$ просто ставится 1 против $t^2 - n$ с нечетным $t$ и соответствующее $t^2 - n$ делится на 2. При $n \equiv 1 \pmod{2}$ решается уравнение $t^2 \equiv n \pmod{2^{\beta}}$ и решение продолжается в том же ключе, как при нечетном $p$.
  %     \item Когда все указанные действия будут проведены для всех простых чисел, не превосходящих $P$, следует отбросить все числа $t^2 - n$, кроме обратившихся в 1 после деления на все степени $p$, не превосходящих $P$. В итоге получится таблица, в которой в $b_i$ столбце будут содержаться все такие значения $t$ из интервала
  %       \begin{equation}
  %         \left[{\left[{\sqrt{n}}\right]+1,\left[{\sqrt{n}}\right]+A}\right],
  %       \end{equation}
  %       что $t^2 - n$ есть $B$-число, а остальные столбцы будут соответствовать тем значениям $p \le P$, для которых $n$ - квадратичный вычет.
  %     \item Далее используется обобщенный метод факторизации Ферма - \cite[Глава 2.1, страница 52]{ish11}
  %   \end{enumerate}
  % \end{comment} 

  \begin{enumerate}
    \item Выберем границы $P$ и $A$ порядка величины $e^{\sqrt{\log{n}\log{\log{n}}}}$. Число $A$ должно быть такое, что $P < A$, но не превышать 
      сравнительно малой его степени, например $P < A < P^2$.
    \item Для $t = [\sqrt{n}] + 1, \: [\sqrt{n}] + 2, \: \dots, \: [\sqrt{n}] + A$ выписываем в столбец по порядку целые числа $t^2 - n$.
    \item Для каждого нечетного простого числа $p \le P$ проверяем условие $\left( \frac{n}{p}\right) = 1$ и при его невыполнении удаляем $p$
     из факторной базы $\pi(P)$.
    \item Если $p$ - нечетное и $n$ - квадратичный вычет по модулю $p$, решаем уравнение $t^2 \equiv n(mod \: p^{\beta})$
      для $\beta = 1, 2, \dots$. Берем $\beta$ в порядке возрастания, пока не окажется, что уравнение не имеет решений $t$, сравнимых по модулю
      $p^{\beta}$ с каким-либо из чисел в области $\sqrt{n} + 1 \le t \le \sqrt{n} + A$. Пусть $\beta$ — наибольшее из таких чисел,
      а $t_1$ и $t_2$ - два решения $t^2 \equiv n(mod \: p^{\beta})$ и $t_2 \equiv -t_1 (mod \: p^{\beta})$.
    \item При том же $p$ Рассматриваем значения $t^2 - n$. В столбце для $p$ ставится 1 против всех $t^2 - n$, для которых $t$ отличается от $t_1$ 
      на некоторое кратное $p$, после заменяется 1 на 2 для всех $t^2 - n$, что $t$ отличается от $t_1$ на кратное $p^2$, и так далее до $p^{\beta}$.
      Затем делается то же самое с $t_2$ вместо $t_1$. Наибольшим числом, которое появляется в этом столбце, будет $\beta$.
    \item Каждый раз, когда ставится 1 или заменяем 1 на 2, 2 на 3 и так далее, делим число $t^2 - n$ на $p$ и сохраняем полученный результат.
    \item В столбце под $p = 2$ при $n \not\equiv 1 (mod \: 8)$ ставим 1 против $t^2 - n$ с нечетным $t$ и делим $t^2 - n$ на 2. 
      При $n \equiv 1 (mod \: 8)$ решаем $t^2 \equiv n (mod \: 2^{\beta})$ (но при $\beta \ge 3$ уравнение будет иметь 4 различных решения
      $t_1$, $t_2$, $t_3$, $t_4$).
    \item Решаем уравнение для всех простых чисел, не превосходящих $P$, отбросив все $t^2 - n$, кроме обратившихся в 1 после деления на
      все степени $p$, не превосходящих $P$, получим следующие результаты:

        \begin{table}[h]
        \centering
          \begin{tabular}{|l|l|l|l|l|l|}
            \hline
            $t$       & $t^2-n$       & $p_1$          & $p_2$          & $\dots$  & $p_P$  \\ \hline
            $t_1$     & $t^{2}_1-n$   & $\alpha_{11}$  & $\alpha_{12}$  & $\dots$  & $\alpha_{1P}$  \\ \hline
            $t_2$     & $t^{2}_2-n$   & $\alpha_{21}$  & $\alpha_{22}$  & $\dots$  & $\alpha_{2P}$  \\ \hline
            $\dots$   & $\dots$       & $\dots$        & $\dots$        & $\dots$  & $\dots$  \\ \hline
            $t_A$     & $t^{2}_A-n$   & $\alpha_{A1}$  & $\alpha_{A2}$  & $\dots$  & $\alpha_{AP}$ \\ \hline
          \end{tabular}
          \caption{$B$-гладкие числа}
          \label{table-quadric-sieve}
        \end{table}

    \item Ищем строки, у которых суммы элементов в каждом столбце четны. Ищем в $t^2 \equiv s^2 (mod \: n)$ величины $t$ и $S$ 
      из 
        \begin{equation}
          s=\prod_{k}{p^{\beta_k}_k}, 
        \end{equation}
        \begin{equation}
          t=\prod_{j}{t_j}
        \end{equation}
      при $1 \le j \le A$, $1 \le k \le P$, где степень $\beta$ для каждого $p$ равна 
      половине $\alpha_{jk}$, $t$ и $S$ удовлетворяют условиям $t \not\equiv \pm s(mod \: n)$. При последовательном прохождении шагов множители $n$ 
      ищем, вычисляя $GCD(t + s, n)$ и $GCD(t - s, n)$.
  \end{enumerate}

  Метод квадратичного решета с использованием нескольких многочленов является эффективным и достаточно легко реализуемым на компьютере алгоритмом. Он, 
по-видимому, является наилучшим из известных алгоритмов факторизации произвольных чисел $n \in N$, $n < 10^{110}$, если не считать метода факторизации с помощью эллиптических кривых, который в некоторых случаях может сработать быстрее. Однако для чисел $n$, больших $10^{110}$, алгоритмы
решета числового поля работают быстрее метода квадратичного решета.


\section{Метод решета числового поля}

\paragraph{} \textit{Метод решета числового поля} - очень сложный алгоритм факторизации чисел, в то же время он позволяет успешно факторизовать числа
  достаточно быстро, однако из-за большого числа сложных шагов, этого алгоритм становится очень медленным и не эффективным при факторизации
  не больших чисел, тем не менее при факторизации больших чисел время, необходимое для выполнения предварительных шагов ничтожно и алгоритм работает
  значительно быстрее аналогов. Этот факт был доказан в 2002 году, когда менее чем за 4 месяца было разложено число, состоящее из 155
  знаков - 512 бит, если бы это число было публичным ключом в \textit{RSA}, то система была бы взломана. Разработка метода решета числового поля 
  поставила под вопрос эффективность крипотсистемы \textit{RSA}.
  
  Метод решета числового поля (как специальный, так и общий) можно представить как усовершенствование более простого метода - метода 
  рационального решета, либо метода квадратичного решета. Подобные им алгоритмы требуют нахождение гладких чисел порядка {$\sqrt{N}$}. 
  Размер этих чисел экспоненциально растёт с ростом {$N$}. Метод решета числового поля, в свою очередь, требует нахождения гладких чисел 
  субэкспоненциального относительно {$N$} размера. Благодаря тому, что эти числа меньше, вероятность того, что число такого размера окажется гладким выше, что и 
  является причиной эффективности метода решета числового поля. Для достижения ускорения вычислений в рамках метода проводятся в числовых 
  полях, что усложняет алгоритм, по сравнению с более простым рациональным решетом - \cite[Глава 5, страницы 145-176]{ish11},
  \cite[Глава 6.4.2, страницы 222-225]{mah06}.
  
  Основные принципы:
    \begin{itemize}
     \item Метод факторизации Ферма для факторизации натуральных нечетных чисел {$n$}, состоящий в поиске таких целых чисел {$x$} и {$y$},
      что {$x^2-y^2-n$}, что ведет к разложению {$n=(x-y)(x+y)$}.
     \item Нахождение подмножества множества целых чисел, произведение которых - квадрат
     \item Составление факторной базы: набора {$\{-1, p_1, \dots, p_n \}$}, где {$p_i$} - простые числа такие, что {$p_i \le B$} 
      для некоторого {$B$}.
     \item Просеивание выполняется подобно решету Эратосфена (откуда метод и получил своё название). Решетом служат простые числа 
      факторной базы и их степени. При просеивании число не «вычёркиваются», а делится на число из решета. Если в результате число 
      оказалось единицей, то оно \textit{B-гладкое}.
     \item Основная идея состоит в том, чтобы вместо перебора чисел и проверки, делятся ли их квадраты по модулю n на простые числа из 
      факторной базы, перебираются простые числа из базы и сразу для всех чисел вида {$x^2-n$} проверяется, делятся ли они на это простое 
      число или его степень.
    \end{itemize}      
    
  \subsection{Алгоритм решета числового поля}
  Пусть {$n$} - нечетное составное число, которое требуется факторизовать.
  
    \begin{enumerate}
      \item Выберем степень неприводимого многочлена {$d \ge 3$} (при {$d = 2$} не будет выигрыша в сравнении с методом квадратичного решета).
      \item Выберем целое {$m$} такое, что {$\lfloor n^\frac{1}{d+1} \rfloor < m < \lfloor n^\frac{1}{d} \rfloor$}, и разложим n по 
	основанию {$m$}:
	
	  \begin{equation} \label{eq:prime-fact-nmd}
	   n = m^d + a_{d-1}m^{d-1} + \dots + a_0.
	  \end{equation}

      \item Свяжем с разложением (2.2.8) неприводимый в кольце {$Z[x]$} полиномов с целыми коэффициентами многочлен
      
	\begin{equation} \label{eq:prime-fact-f1xd}
	 f_1(x)=x^d + a_{d-1}x^{d-1} + \dots + a_0.
	\end{equation}

      \item Определим полином просеивания {$F_1(a,b)$} как однородный многочлен от двух переменных {$a$} и {$b$}:
      
	\begin{equation} \label{eq:prime-fact-F1ab}
	 F_1(a,b) = b^d f_1(a/b) = a^d + a_{d-1}a^{d-1}b + \dots + a_0 b^d.
	\end{equation}

      \item Определим второй полином и соответствующий однородный многочлен {$F_2(a,b)=a-bm, f_2(x)=x-m$} .
      \item Выберем два положительных числа {$L_1$} и {$L_2$}, определяющих область просеивания:
      
	\begin{equation} \label{eq:prime-fact-SR}
	 SR = \{ 1 \le b \le L_1, -L_2 \le a \le L_2 \}.
	\end{equation}

      \item Пусть {$\theta$} - корень {$f_1(x)$}. Рассмотрим кольцо полиномов {$Z[\theta]$}. Определим множество, называемое алгебраической 
	факторной базой {$FB_1$}, состоящее из многочленов первого порядка вида {$a-b\theta$} с нормой (2.2.10), являющейся простым числом. 
	Эти многочлены - простые неразложимые в кольце алгебраических целых поля {$K=Q[\theta]$}. Ограничим абсолютные значения норм 
	полиномов из {$FB_1$} константой {$L_1$}.
	
      \item Определим рациональную факторную базу {$FB_2$}, состоящую из всех простых чисел, ограниченных сверху константой {$L_2$}.
      \item Определим множество {$FB_3$}, называемое факторной базой квадратичных характеров. Это множество полиномов первого порядка
	{$c-d\theta$}, норма которых - простое число. Должно выполняться условие {$FB_1 \bigcap FB_3 = \O{}$}.
      \item Выполним просеивание многочленов {$\{ a - b\theta \;|\; (a,b) \in SR \}$} по факторной базе {$FB_1$} и целых чисел
	{$\{ a-bm \;|\; (a,b) \in SR \}$} по факторной базе {$FB_2$}. В результате получим множество {$M$}, состоящее из гладких пар {$(a,b)$}, 
	то есть таких пар {$(a,b)$}, что {$GCD(a,b) = 1$}, полином и число {$a-b\theta$} и {$a-bm$} раскладываются полностью по {$FB_1$} и
	{$FB_2$} соответственно.
      \item Найдём такое подмножество {$S \subseteq M$}, что
      
	\begin{equation} \label{eq:prime-fact-pab}
	 \prod_{(a,b) \in S}{(a-b\theta)}=H^2, H \in Z; \prod_{(a,b) \in S}{(a-bm)}=B^2, B \in Z.
	\end{equation}

      \item Определим многочлен
      
	\begin{equation} \label{eq:prime-fact-gt}
	  g(\theta)= f'\textsuperscript{2}_1(\theta) \prod_{(a,b) \in S}{(a-b\theta)},
	\end{equation}
	где {$f'_1(x)$} - производная {$f_1(x)$}

      \item Многочлен {$g(\theta)$} является полным квадратом в кольце полиномов {$Z[\theta]$}. Пусть тогда {$\alpha(\theta)$} есть корень
	из {$g(\theta)$} и {$B$} - корень из {$B^2$}.
      \item Строим отображение {$\phi:\theta \rightarrow m$}, заменяя полином {$\alpha(\theta)$} числом {$\alpha(m)$}. 
	Это отображение является кольцевым гомоморфизмом кольца алгебраических целых чисел {$Z_k$} в кольцо {$Z$}, откуда получаем 
	соотношение:
	
	  \begin{subequations}
	    \begin{center}
	      {$A^2 = g(m)^2 \equiv \phi(g(\alpha))^2 \equiv$} \\
	      {$\equiv \phi(f'^2_1(\theta)\prod_{(a,b \in S)}{(a-b\theta)}) \equiv$} \\
	      {$\equiv f'^2_1(m)\prod_{(a,b \in S)}{(a-bm)} \equiv$} \\
	      {$\equiv f'^2_1(m) C^2 (mod \: n)$}
	    \end{center}
	  \end{subequations}

      \item Пусть {$B=f'(m)C$}. Найдём пару чисел {$(A, B)$} таких, что {$A \equiv B(mod n)$}. Тогда найдём делитель числа {$n$},
	вычисляя {$GCD(n, A \pm B)$}, как это делается, например, в методе квадратичного решета.
    \end{enumerate}

  
\section{Заключение}

\paragraph{} Факторизация натурального числа - это его разложение в произведение простых множителей. Большая вычислительная сложность и трудоемкость легли в основу одного из самых популярных методов криптографии с открытым ключом, метода RSA. Соответственно основой криптосистемы RSA является сложность факторизации больших чисел.
  
  В работе были рассмотрены алгоритмы факторизации двух видов (групп), первая группа - экспоненциальные 
  алгоритмы, вторая группа - субэкспоненциальные алгоритмы, то есть те алгоритмы, которые работают более, чем за полиномиальное время («сверх-полиномиальное»),
  но менее, чем за экспоненциальное время («субэкспоненциальное»). Для обозначения их сложности принята \textit{L-нотация}:  
    \begin{equation} \label{eq:prime-fact-lnc}
     L_N(\alpha,c)=O(exp((c+o(1))(logN)^\alpha(loglogN)\textsuperscript{{$1-\alpha$}})), 
    \end{equation}    
  где {$N$} - число, которое подлежит факторизации, а {$0 < \alpha < 1$} и {$c$} - некоторые константы, преимуществом этой нотации является упрощение 
  анализа алгоритмов.
  
    \begin{enumerate}
     \item Экспоненциальные алгоритмы
     
    	\begin{enumerate}
    	 \item перебор возможных делителей - {$O(N\textsuperscript{{$\frac{1}{2}$}})$}
    	 \item метод факторизации Ферма - {$O(N\textsuperscript{{$\frac{1}{4}$}})$}
    	 \item {$\rho$}-алгоритм Полларда - {$O(N\textsuperscript{{$\frac{1}{4}$}})$}
    	\end{enumerate}
     
     \item Субэкспоненциальные алгоритмы
     
    	\begin{enumerate}
    	 \item алгоритм Диксона - {$L_N(\frac{1}{2}, 2\sqrt{2})$}
    	 \item метод непрерывных дробей - {$L_N(\frac{1}{2}, \sqrt{2})$}
    	 \item метод квадратичного решета - {$L_N(\frac{1}{2}, 1)$}	
    	\end{enumerate}

    \end{enumerate}
    
      Наряду с описанными выше алгоритмами существует более эффективный алгоритм, в данный момент он является самым эффективным. Этим алгоритмом является алгоритм факторизации
    решета числового поля, существуют две его вариации:
    
      \begin{enumerate}
       \item Специальный метод решета числового поля со сложностью {$L_N(\frac{1}{3}, (\frac{32}{9})^\frac{1}{3})$} 
	(метод применим для факторизации чисел только специального вида).
       \item Общий метод решета числового поля со сложностью {$L_N(\frac{1}{3}, (\frac{64}{9})^\frac{1}{3})$} 
	(метод применим ко всем числам).
      \end{enumerate}      
      
  % Алгоритм Ленстры на практике часто используется для выявления (отбрасывания) небольших простых делителей числа. Однако если мы 
  % работаем с числом, содержащим в себе крупные простые множители, то нам нужно увеличивать количество кривых, так как при увеличении 
  % количества кривых шансы найти простой делитель возрастают, тем не менее, зависимость ожидаемого количества эллиптических кривых от 
  % количества цифр в искомом делителе экспоненциальна. Метод Полларда очень быстро находит простые факторы малой и средней величины, однако,
  % столкнувшись с крупным простым сомножителем, становится малоэффективным.
  
  % Среди алгоритмов факторизации с экспоненциальной сложностью метод квадратичных форм Шенкса считается одним из самых эффективных. 
  % Этот алгоритм работает с целыми числами, не превосходящими $2\sqrt{N}$. Мы знаем, что для 32-разрядных компьютеров алгоритмы, основанные на данном 
  % методе, являются безусловными лидерами из алгоритмов факторизации для чисел между $10^{10}$ до $10^{18}$ и, вероятно, таковым и останутся. 
  % Данный алгоритм может разделить практически любое составное 18-значное число менее чем за миллисекунду. Алгоритм является чрезвычайно 
  % простым, красивым и эффективным. Кроме того, методы, базирующиеся на данном алгоритме, используются как вспомогательные при разложении 
  % делителей больших чисел.
  
  % Самым простым и самым трудоёмким экспоненциальным методом, реализуемым вручную, является подбор делителей. Он заключается в переборе 
  % потенциальных делителей числа в пределах от самого числа до его квадрата. Для разложения небольших чисел он вполне подходит, так как 
  % очень просто реализуется, но для разложения массивных чисел он практически непригоден.

  Можно выделить, что рассмотренные субэкспоненциальные алгоритмы построены по одинаковой схеме:
    \begin{enumerate}
      \item Строится база разложения $B$.
      \item Осуществляется поиск $B$-гладких чисел $x$ и $y$ таких, что $x \equiv y (mod \: N)$.
      \item Ищется комбинация $x$ и $y$ такая, что $x^2 \equiv y^2 (mod \: N)$.
      \item Находим делитель $N$ как GCD($x-y$, $N$).
    \end{enumerate}

  В рассмотренных алгоритмах отличаются лишь способы достижения описанных выше пунктов.
  
  Выбор оптимального алгоритма для факторизации зависит от многих параметров и характеристик. Таковыми характеристиками, применительно к алгоритму, 
  являются тип алгоритма - экспоненциальный или субэкспоненциальный, а также его вычислительная сложность, от этих двух характеристик зависит скорость работы алгоритма факторизации. Кроме того, важным фактором является структура числа, подлежащего разложению, соответственно для каждого числа необходимо подбирать алгоритм основываясь не только на характеристиках алгоритмов, но также и на структуре числа. 

  Из этого можно сделать следующие выводы: не смотря на то, что существует много способов и алгоритмов факторизации, задача все еще остается не тривиальной и требует дополнительных исследований, она затратна в плане времени и ресурсов. Многие хорошие и быстрые алгоритмы просто не могут справиться с разложением число просто по причине сложной или не подходящей под алгоритм структурой. Помимо этого важно учитывать размерность чисел и использовать алгоритмы, подходяшие для этих параметров, чтобы избежать дополнительного и излишнего использования ресурсов и времени. Таким образом важным является подбор подходящего алгоритма факторизации, это позволит уменьшит временные затраты на процесс разложения. К примеру, нет смысла раскладывать 10-ти значное число алгоритмом квадратичного решета или алгоритмом решета числового поля, с такими числами успешно справятся и экспоненциальные алгоритмы, посколько размерность числа не большая, а алгоритмы решета требует достаточно много дополнительных вычислений.

  Из этих выводов следует, что задача факторизации опирается не только на вычислительные мощности, а так же на новые достижения в области математики, развитие области теории чисел, главным же вопросом остается существования полиномиального алгоритма факторизации больших целых чисел.
  % Применение на практике различных методов разложения чисел показало, что время выполнения алгоритма напрямую зависит от его типа и 
  % вычислительной сложности. 

  % В данной работе мы рассмотрели некоторые алгоритмы факторизации натуральных чисел, а также провели сравнительную
  % характеристику оных по группам структур. На практических примерах мы убедились в эффективности и целесообразности применения одних 
  % методов перед другими, опять же с учётом структуры данного числа.
  
  % Таким образом, можно сделать следующие выводы: для факторизации натуральных чисел существует достаточно много способов, но эта задача
  % далеко не тривиальная, и довольно затратна в плане времени, об этом говорит оценка сложности алгоритмов факторизации. Некоторые 
  % алгоритмы могут решать поставленную задачу веками. Для того, чтобы уменьшить время ожидания, нужно подобрать соответствующий структуре
  % числа метод факторизации.
  
  % Но решение данной проблемы не стоит на месте, поскольку многие крупные открытия и новые достижения в этой области появляются снова и снова.
  % Эти достижения обусловлены не только развитием вычислительной мощности компьютеров и сетей, но и развитием тех областей теоретической 
  % математики, которые до недавнего времени служили областью интересов лишь профессиональных математиков-специалистов в абстрактной алгебре и
  % теории чисел.
 
