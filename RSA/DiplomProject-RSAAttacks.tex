\section{Атаки на RSA}

\subsection{Relaxed RSA problem}

\subsection{Атака Франклина-Райтера}

\paragraph{} Предположим, что у нас есть открытый ключ RSA, принадлежащий A. Атака Франклина-Рейтера применяется в следующей ситуации. B хочет отправить A два шифрованных 
  сообщения \textit{{$m_1$}} и \textit{{$m_2$}}, связанных друг с другом с помощью следующего открытого многочлена \textit{{$ m_2 = f(m_1)(mod n) $}}
  
  По соответствующим шифротекстам \textit{{$c_1$}} и \textit{{$c_2$}} нападающий имеет хорошие шансы раскрыть сообщения \textit{{$m_1$}} и \textit{{$m_2$}} при любой небольшой
  шифрующей экспоненте \textit{e}. Атака наиболее проста, если \textit{f = aх + b} и \textit{e = 3}, причем \textit{a} и \textit{b} фиксированы и известны атакующему. 
  Нападающий знает, что \textit{{$m_2$}} - корень по модулю \textit{n} многочленов
  
    \begin{equation}
      \textit{{$ g_1(x) = x^3 - c_2 g_2(x) = (f(x))^3 - c_1 $}}
    \end{equation}

  Поэтому линейная функция \textit{{$х - m_2$}} делит как \textit{{$ g_1(x) $}}, так и \textit{{$ g_2(x) $}}.
  
  Можно показать, что в случае \textit{f = aх + b} и \textit{e = 3} искомый наибольший общий делитель (если таковой существует) должен быть линейным множителем 
  многочлена \textit{{$x - m_2$}}, то есть совпадать с ним. Значит, нападающий найдет \textit{{$m_2$}}, а затем \textit{{$m_1$}}.
  
  Обобщение Копперсмита атаки Франклина и Рейтера строится по пути, на котором можно получить дополнительный результат из атаки Хастада. Предположим, что сообщение \textit{m} 
  перед шифрованием пополняется некоторыми случайными данными. Например, если \textit{n} - \textit{n-битовый} модуль \textit{RSA}, а \textit{m} - \textit{k-битовое} сообщение, 
  то можно добавить \textit{n - k} случайных битов либо в начало, либо в конец сообщения. Пусть \textit{{$ m' = 2\textsuperscript{n-k}m + r $}}, где \textit{r} - зависящее от 
  \textit{m} случайное число длины \textit{n - k}. Копперсмит показал, что такое пополнение сообщения нестойко.
  
  Предположим, что B дважды посылает одно сообщение A, то есть возникает два шифротекста \textit{{$ m_1 = 2\textsuperscript{n-k}m + r_1 $}} и
  \textit{{$ m_2 = 2\textsuperscript{n-k}m + r_2 $}} соответствующих сообщениям где \textit{{$r_1$}} и \textit{{$r_2$}} - два разных случайных числа, состоящие из 
  \textit{n - k} битов. Атакующий вводит обозначение \textit{{$ y_0 = r_2 - r_1 $}} и пытается решить
  систему уравнений
  
    \begin{equation}
	  \begin{cases}
	    g_1(x,y) &= x^e - c_1 \\
	    g_2(x,y) &= (x+y)^e - c_2
	  \end{cases}    
      \end{equation}
      
  Он вычисляет результант \textit{h(y)} многочленов \textit{{$g_1(x,y)$}} и \textit{{$g_2(x,у)$}} относительно переменной \textit{х}. Теперь \textit{{$y_0$}} -
  маленький корень многочлена \textit{h(y)} степени \textit{{$e^2$}}. Опираясь на теорему Копперсмита, нападающий находит разность \textit{{$r_2 - r_1$}} и 
  узнает \textit{{$m_2$}}, используя метод атаки Франклина-Рейтера.

\subsection{Расширенная атака Хастаадта}

\subsection{Factoring with High Bits Known}

\subsection{Атака Винера}

\paragraph{} Мы уже отмечали, что в алгоритме \textit{RSA} для ускорения операций с открытым ключом используют малые шифрующие экспоненты. В некоторых же 
  приложениях этой криптосистемы существеннее ускорить процессы расшифровывания. Поэтому имеет смысл выбирать небольшую расшифровывающую экспоненту
  \textit{d}. Ясно, что при этом получается большое значение открытой экспоненты \textit{e}. Слишком маленькое число в качестве секретной экспоненты \textit{d} мы 
  брать не можем, поскольку атакующий определит ее простым перебором. Более того, учитывая атаку Винера, опирающуюся на непрерывные дроби,
  необходимо выбирать \textit{d} среди чисел, размер которых не меньше, чем \textit{{$ \frac{1}{3} N^\frac{1}{4} $}}
  
  По вещественному числу \textit{{$ \alpha \in R $}} определим последовательности:
  
  \begin{subequations}
      \begin{center}
	\textit{{$ \alpha_0 = \alpha, p_0 = q_0 = 1, p_1 = a_0 a_1 + 1, q_1 = a_1 $}},\\
	\textit{{$ a_i = \lfloor \alpha_i \rfloor, \alpha\textsubscript{i+1} = \frac{1}{\alpha_i - a_i} $}}, \\
	\textit{{$ p_i = a_i p\textsubscript{i-1} + p\textsubscript{i-2}, q_i = a_i q\textsubscript{i-1} + q\textsubscript{i-2}, i \ge 2$}},
      \end{center}
  \end{subequations}
  
  Целые числа \textit{{$ \alpha_0, \alpha_1, \alpha_2, \dots $}} называются непрерывной дробью, представляющей \textit{{$\alpha$}}, а рациональные числа \textit{{$ \frac{p_i}{q_i} $}}
  - подходящими дробями. Каждая из подходящих дробей несократима, а скорость роста их знаменателей сравнима с показательной.
  
  Одним из важных результатов теории непрерывных дробей является то, что если несократимая дробь удовлетворяет неравенству:
  
    \begin{equation}
	\textit{{$ | \alpha - \frac{p}{q} | \le \frac{1}{2 q^2} $}},
    \end{equation}

  то \textit{{$ \frac{p}{q} $}} - одна из подходящих дробей в разложении \textit{{$\alpha$}} в непрерывную дробь.
  
  Винер предлагает использовать непрерывные дроби при атаке на \textit{RSA} следующим образом. Пусть у нас есть модуль \textit{N = p q}, причем \textit{q < р < 2q}. 
  Допустим, что наша расшифровывающая экспонента удовлетворяет неравенству \textit{{$d < \frac{1}{3} N^\frac{1}{4} $}}, и нападающему это известно. Кроме того, ему дана 
  шифрующая экспонента \textit{e}, обладающая свойством 
  
    \begin{equation}
      \textit{{$ e d = 1 (mod \phi), \phi = \phi(N) = (p - 1)(q - 1) $}}
    \end{equation}
  
  Будем также считать, что \textit{{$e < \phi$}}, поскольку это выполнено в большинстве приложений. Заметим, из предположений следует существование такого целого \textit{k}, что
  \textit{{$e d - k \phi = 1$}}. Следовательно,
  
    \begin{equation}
     \textit{{$ |\frac{e}{\phi} - \frac{k}{d}| = \frac{1}{d \phi} $}}
    \end{equation}
    
  Поскольку \textit{{$\phi \approx n$}}, получаем, что
  
    \begin{equation}
     \textit{{$ |n - \phi| = |p + q - 1| < 3 \sqrt{n} $}}
    \end{equation}

  Отсюда можно сделать вывод, что \textit{{$ \frac{e}{n} $}} - довольно хорошее приближение в \textit{{$ \frac{k}{d} $}}. Действительно,
  
    \begin{subequations}
      \begin{center}
	\textit{{$|\frac{e}{n} - \frac{k}{d}| = |\frac{e d - n k}{d n}| = |\frac{e d - k \phi - n k + k \phi}{d n}| = $}} \\
	\textit{{$= |\frac{1 - k(n - \phi)}{d n}| \le |\frac{3 k \sqrt{n}}{d n}| = |\frac{3 k}{d \sqrt{n}}|$}}
      \end{center}
    \end{subequations}
    
  Поскольку \textit{{$e < \phi$}}, очевидно, \textit{k < d}. Кроме того, по предположению \textit{{$d < \frac{1}{3} N^\frac{1}{4} $}}. Значит, 
  \textit{{$ |\frac{e}{n} - \frac{k}{d}| < \frac{1}{2 d^2} $}}
  
  Поскольку \textit{НОД(k, d) = 1}, мы видим, что - подходящая дробь в разложении дробив непрерывную. Таким образом, раскладывая числов непрерывную дробь, можно узнать 
  расшифровывающую экспоненту, поочередно подставляя знаменатели подходящих дробей в выражение \textit{{$(M^e)^d= М (mod n)$}} для некоторого случайного числа \textit{М}. 
  Получив равенство, найдем \textit{d}. Общее число подходящих дробей, которое нам придется при этом проверить, оценивается как \textit{О(ln n)}. 
  Таким образом, изложенный метод дает линейный по сложности алгоритм определения секретного ключа в системе \textit{RSA}, если последний не превосходит 
  \textit{{$\frac{1}{3} N^\frac{1}{4} $}}
  
  \begin{example}
    В качестве примера рассмотрим модуль RSA, равный \textit{n = 9449868410449}. Пусть открытый ключ криптосистемы задан как \textit{e = 6792605526025},
    а секретный ключ удовлетворяет неравенству \textit{d = 584}. Разложим число \textit{{$ \alpha = \frac{e}{n} $}} непрерывную дробь и проверим знаменатель каждой 
    подходящей дроби: не является ли он секретным ключом. Подходящие дроби разложения \textit{{$ \alpha $}} имеют вид:
    
      \begin{equation}
	\textit{{$ 1, \frac{2}{3}, \frac{3}{4}, \frac{5}{7}, \frac{18}{25}, \frac{23}{32}, \frac{409}{569}, \frac{1659}{2308}, \dots$}}
      \end{equation}

    Поочередно проверяя знаменатели, убедимся, что \textit{d = 569}, то есть знаменатель седьмой подходящей дроби - искомый секретный ключ.
  \end{example}



